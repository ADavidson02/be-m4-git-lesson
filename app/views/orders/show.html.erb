<div class="single-order">
  <div>
    <h3>Order No: <%= @order.id %></h3>
  </div>
  <div>
    <h3>Status: <%= @order.status %></h3>
  </div>
  <% if @order.status == 3 || @order.status == 4 %>
    <div>
        <h3>Updated On: <%= @order.format_date(@order.updated_at)%></h3>
    </div>
  <% end %>
  <div>
    <h3>Placed On: <%= @order.format_date(@order.created_at) %></h3>
  </div>
</div>

<table class="single-order-items">
  <thead>
    <tr>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Price</th>
      <th>Subtotal</th>
    </tr>
  </thead>
  <tbody>
    <% @order.items.uniq.each do |item| %>
    <tr>
      <td><%= link_to "#{item.title}", item_path(item) %></td>
      <td><%= item.order_items.item_quantity(@order.id, item.id) %></td>
      <td><%= item.order_items.find_by(item_id: item.id).price %></td>
      <td><%= number_to_currency(item.order_items.item_subtotal(@order.id, item.id)) %></td>
    </tr>
    <% end %>
    <tr class=last-row>
      <td class="last-row-title" colspan="3">Total:</td>
      <td><%= number_to_currency(@order.order_items.total(@order.id)) %></td>
    </tr>
  </tbody>
</table>
